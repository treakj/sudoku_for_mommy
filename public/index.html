<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo de Sudoku v0.9</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation;
        }

        body.lang-ja {
            font-family: 'Noto Sans JP', sans-serif;
        }

        body.lang-pt,
        body.lang-en {
            font-family: 'Inter', sans-serif;
        }

        .canvas-container {
            width: 100%;
            max-width: 600px;
            aspect-ratio: 1 / 1;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
            border-radius: 0.5rem;
        }

        .btn-difficulty.active {
            background-color: #1E40AF;
            color: white;
            border-color: #1E40AF;
        }

        #loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .btn-action:disabled {
            background-color: #9CA3AF;
            cursor: not-allowed;
        }

        /* Estilos para o menu "Como Jogar" */
        .controls-info-panel {
            margin: 1rem 0;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .controls-info {
            border: 2px solid #e5e7eb;
            border-radius: 0.75rem;
            overflow: hidden;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .controls-info[open] {
            border-color: #3b82f6;
            box-shadow: 0 10px 25px -3px rgba(59, 130, 246, 0.1);
        }

        .controls-summary {
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 600;
            color: #374151;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: none;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            user-select: none;
        }

        .controls-summary:hover {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        }

        .controls-summary::-webkit-details-marker {
            display: none;
        }

        .controls-summary::before {
            content: '‚ñ∂';
            margin-right: 0.5rem;
            transition: transform 0.3s ease;
        }

        .controls-info[open] .controls-summary::before {
            transform: rotate(90deg);
        }

        .controls-content {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .control-section {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 0.5rem;
            border-left: 4px solid #3b82f6;
        }

        .control-section h4 {
            font-size: 1rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .control-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
            gap: 0.5rem;
        }

        .control-section li {
            padding: 0.375rem 0;
            color: #4b5563;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            transition: color 0.2s ease;
        }

        .control-section li::before {
            content: '‚Ä¢';
            color: #3b82f6;
            margin-right: 0.5rem;
            font-weight: bold;
        }

        .control-section kbd {
            background-color: #374151;
            color: white;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-family: 'Courier New', monospace;
            margin: 0 0.125rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .controls-content {
                grid-template-columns: 1fr;
                gap: 1rem;
                padding: 1rem;
            }

            .control-section {
                padding: 0.75rem;
            }

            .control-section h4 {
                font-size: 0.9rem;
            }

            .control-section li {
                font-size: 0.8rem;
                padding: 0.25rem 0;
            }

            .controls-summary {
                padding: 0.75rem 1rem;
                font-size: 1rem;
            }
        }

        /* Estilos para o sistema de notas */
        .notes-toggle-btn.notes-active,
        #notes-btn.notes-active {
            background-color: #7c3aed !important;
            box-shadow: 0 0 0 2px #a855f7;
            transform: scale(1.05);
        }

        .cell-notes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 1px;
            pointer-events: none;
            z-index: 1;
        }

        .note-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            font-weight: 500;
            color: #6b7280;
            background: transparent;
        }

        .note-cell.note-active {
            color: #374151;
            font-weight: 600;
        }

        .has-notes {
            position: relative;
        }

        .has-notes .cell-number {
            z-index: 2;
            position: relative;
        }

        .notes-active {
            background-color: rgba(139, 92, 246, 0.1) !important;
            border: 2px solid #8b5cf6 !important;
        }

        /* Estilos para bot√µes de idioma */
        .lang-btn.active {
            background-color: #1E40AF !important;
            color: white !important;
            transform: scale(1.05);
        }

        .lang-btn {
            min-width: 32px;
        }

        /* Estilos melhorados para o bot√£o de notas */
        #notes-btn {
            position: relative;
            background-color: #8b5cf6 !important;
            transition: all 0.3s ease !important;
        }

        #notes-btn.notes-active {
            background-color: #7c3aed !important;
            color: white !important;
            box-shadow: 0 0 0 3px #a855f7, 0 0 20px rgba(124, 58, 237, 0.6) !important;
            transform: scale(1.1) !important;
            border: 3px solid #5b21b6 !important;
        }

        #notes-btn.notes-active::before {
            content: '‚úì';
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #10b981;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid white;
        }

        #notes-btn.notes-active:hover {
            background-color: #6d28d9 !important;
            transform: scale(1.12) !important;
        }
        
        /* Anima√ß√£o de pulse para bot√£o ativo */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }
        
        /* Estilos para notifica√ß√µes */
        .palette-notification {
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Feedback visual para sele√ß√£o de cores */
        .color-btn {
            transition: all 0.2s ease;
            border: 2px solid #d1d5db;
            position: relative;
        }

        .color-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.2);
            border-color: #6b7280;
        }

        .color-btn.selected {
            border: 4px solid #2563eb !important;
            box-shadow: 0 0 0 2px white, 0 0 0 6px #2563eb, 0 0 20px rgba(37, 99, 235, 0.4) !important;
            transform: scale(1.2) !important;
        }

        .color-btn.selected::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        /* Estilos para o sistema de cores */
        #color-indicator {
            animation: fadeIn 0.3s ease-in;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .color-palette {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .color-btn {
            transition: all 0.2s ease;
        }

        .color-btn:hover {
            transform: scale(1.1);
        }

        .color-btn.ring-2 {
            animation: pulse 0.5s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl mx-auto">
        <header class="text-center mb-4 relative">
            <h1 id="main-title" class="text-3xl md:text-4xl font-bold text-gray-900">Jogo de Sudoku <span class="text-lg text-blue-600">v0.9</span></h1>
            <p id="subtitle" class="text-gray-600 mt-1">Desafie sua l√≥gica e divirta-se!</p>
            
            <!-- Indica√ß√µes de Controle -->
            <div class="controls-info-panel mt-4">
                <details class="controls-info">
                    <summary class="controls-summary">‚ÑπÔ∏è <span id="how-to-play-title" data-translate="how-to-play">Como Jogar</span></summary>
                    <div class="controls-content" id="how-to-play-content">
                        <div class="control-section">
                            <h4>‚å®Ô∏è <span data-translate="keyboard">Teclado</span></h4>
                            <ul id="keyboard-controls">
                                <li><kbd>1-9</kbd> <span data-translate="insert-numbers">Inserir n√∫meros</span></li>
                                <li><kbd>Shift</kbd> + <kbd>1-9</kbd> <span data-translate="notes-mode">Modo notas</span></li>
                                <li><kbd>Q</kbd> <span data-translate="toggle-notes">Alternar modo notas</span></li>
                                <li><kbd>C</kbd> <span data-translate="cycle-colors">Alternar entre cores</span></li>
                                <li><kbd>Space</kbd> <span data-translate="apply-color">Aplicar cor selecionada</span></li>
                                <li><kbd>Ctrl+Z</kbd> <span data-translate="undo">Desfazer</span></li>
                                <li><kbd>Ctrl+Y</kbd> <span data-translate="redo">Refazer</span></li>
                                <li><kbd>H</kbd> <span data-translate="hint">Dica</span></li>
                                <li><kbd>Delete</kbd> <span data-translate="delete">Apagar</span></li>
                                <li><kbd>‚Üë‚Üì‚Üê‚Üí</kbd> <span data-translate="navigate">Navegar</span></li>
                            </ul>
                        </div>
                        <div class="control-section">
                            <h4>üñ±Ô∏è <span data-translate="mouse-touch">Mouse/Touch</span></h4>
                            <ul id="mouse-controls">
                                <li><span data-translate="click-select">Clique para selecionar c√©lula</span></li>
                                <li><span data-translate="click-highlight">Clique em n√∫mero para destacar</span></li>
                                <li><span data-translate="mobile-panel">Mobile: Use painel inferior</span></li>
                            </ul>
                        </div>
                        <div class="control-section">
                            <h4>üéØ <span data-translate="features">Recursos</span></h4>
                            <ul id="features-list">
                                <li>üî¢ <span data-translate="number-counter">Contador de n√∫meros (canto)</span></li>
                                <li>üìù <span data-translate="notes-system">Sistema de notas</span></li>
                                <li>üé® <span data-translate="color-system">Sistema de cores</span></li>
                                <li>üéØ <span data-translate="auto-highlight">Destaque autom√°tico</span></li>
                            </ul>
                        </div>
                    </div>
                </details>
            </div>
            
            <button id="lang-toggle" style="display: none;"
                class="absolute top-0 right-0 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors">
                PT
            </button>
            
            <div class="absolute top-0 right-0 flex gap-1">
                <button id="lang-pt" class="lang-btn bg-blue-500 text-white px-2 py-1 rounded text-sm font-semibold hover:bg-blue-600 transition-colors" data-lang="pt">PT</button>
                <button id="lang-en" class="lang-btn bg-gray-300 text-gray-700 px-2 py-1 rounded text-sm font-semibold hover:bg-gray-400 transition-colors" data-lang="en">EN</button>
                <button id="lang-ja" class="lang-btn bg-blue-500 text-white px-2 py-1 rounded text-sm font-semibold hover:bg-blue-600 transition-colors" data-lang="ja">JP</button>
            </div>
        </header>

        <main class="bg-white p-4 sm:p-6 rounded-xl shadow-lg">
            <!-- Controles de Dificuldade -->
            <div class="flex flex-wrap gap-2 sm:gap-4 justify-center mb-4 items-center">
                <div class="flex items-center gap-1 sm:gap-2 flex-wrap justify-center">
                    <span id="difficulty-label" class="font-semibold">Dificuldade:</span>
                    <button data-difficulty="easy"
                        class="btn-difficulty border-2 border-gray-300 px-2 py-1 rounded-md text-xs sm:text-sm font-medium transition-colors hover:bg-blue-100"
                        data-lang-key="easy">F√°cil</button>
                    <button data-difficulty="medium"
                        class="btn-difficulty border-2 border-gray-300 px-2 py-1 rounded-md text-xs sm:text-sm font-medium transition-colors hover:bg-blue-100 active"
                        data-lang-key="medium">M√©dio</button>
                    <button data-difficulty="hard"
                        class="btn-difficulty border-2 border-gray-300 px-2 py-1 rounded-md text-xs sm:text-sm font-medium transition-colors hover:bg-blue-100"
                        data-lang-key="hard">Dif√≠cil</button>
                    <button data-difficulty="expert"
                        class="btn-difficulty border-2 border-gray-300 px-2 py-1 rounded-md text-xs sm:text-sm font-medium transition-colors hover:bg-blue-100"
                        data-lang-key="expert">Dific√≠limo</button>
                    <button data-difficulty="insane"
                        class="btn-difficulty border-2 border-gray-300 px-2 py-1 rounded-md text-xs sm:text-sm font-medium transition-colors hover:bg-blue-100"
                        data-lang-key="insane">Dific√≠limo Mesmo</button>
                </div>
            </div>

            <!-- Controles de A√ß√£o - Primeira Linha -->
            <div class="flex flex-wrap gap-2 sm:gap-4 justify-center mb-2 game-controls">
                <button id="new-game-btn"
                    class="bg-blue-600 text-white px-4 py-2 rounded-md font-semibold hover:bg-blue-700 transition-transform transform hover:scale-105"
                    data-lang-key="newGame">Novo Jogo</button>
                <button id="reset-btn"
                    class="bg-gray-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-gray-600 transition-transform transform hover:scale-105"
                    data-lang-key="reset">Limpar</button>
                <button id="undo-btn"
                    class="bg-indigo-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-indigo-600 transition-transform transform hover:scale-105">‚Ü∂ Desfazer</button>
                <button id="redo-btn"
                    class="bg-indigo-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-indigo-600 transition-transform transform hover:scale-105">‚Ü∑ Refazer</button>
                <button id="notes-btn"
                    class="btn-action bg-purple-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-purple-600 transition-transform transform hover:scale-105"
                    data-lang-key="notes">üìù Notas</button>
            </div>

            <!-- Controles de A√ß√£o - Segunda Linha -->
            <div class="flex flex-wrap gap-2 sm:gap-4 justify-center mb-4 game-controls">
                <button id="color-btn"
                    class="btn-action bg-orange-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-orange-600 transition-transform transform hover:scale-105">üé® Cores</button>
                <button id="hint-btn"
                    class="btn-action bg-green-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-green-600 transition-transform transform hover:scale-105"
                    data-lang-key="hint">Dica (3)</button>
                <button id="show-answer-btn"
                    class="btn-action bg-yellow-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-yellow-600 transition-transform transform hover:scale-105"
                    data-lang-key="showAnswer">Resposta</button>
                <button id="clear-colors-btn"
                    class="bg-red-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-red-600 transition-transform transform hover:scale-105">üóëÔ∏è Limpar Cores</button>
                <button id="settings-btn"
                    class="bg-teal-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-teal-600 transition-transform transform hover:scale-105">‚öôÔ∏è Config</button>
            </div>

            <!-- Canvas do Jogo -->
            <div class="canvas-container mx-auto relative">
                <canvas id="sudoku-canvas"></canvas>
                <div id="loader-container"
                    class="absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center hidden">
                    <div id="loader"></div>
                </div>
            </div>
            <!-- Painel de N√∫meros para Mobile -->
            <div id="number-panel" class="grid grid-cols-10 gap-1 mt-4">
                <button data-num="1"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">1</button>
                <button data-num="2"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">2</button>
                <button data-num="3"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">3</button>
                <button data-num="4"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">4</button>
                <button data-num="5"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">5</button>
                <button data-num="6"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">6</button>
                <button data-num="7"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">7</button>
                <button data-num="8"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">8</button>
                <button data-num="9"
                    class="num-btn bg-gray-200 p-2 rounded-md text-xl font-bold hover:bg-blue-200 aspect-square flex items-center justify-center">9</button>
                <button data-num="0"
                    class="num-btn bg-red-200 p-2 rounded-md text-xl font-bold hover:bg-red-300 aspect-square flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.414 6.414a2 2 0 002.828 0L21 12M3 12l6.414-6.414a2 2 0 012.828 0L21 12" />
                    </svg>
                </button>
            </div>
        </main>

        <!-- Modal de Vit√≥ria -->
        <div id="win-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-white p-8 rounded-lg shadow-2xl text-center transform transition-all scale-95">
                <h2 id="win-title" class="text-3xl font-bold text-yellow-500 mb-2">Parab√©ns!</h2>
                <p id="win-subtitle" class="text-lg text-gray-700 mb-6">Voc√™ completou o Sudoku!</p>
                <button id="modal-new-game-btn"
                    class="bg-blue-600 text-white px-6 py-2 rounded-md font-semibold hover:bg-blue-700 transition-transform transform hover:scale-105"
                    data-lang-key="playAgain">Jogar Novamente</button>
            </div>
        </div>

        <!-- Modal de Confirma√ß√£o para Mostrar Resposta -->
        <div id="confirm-modal"
            class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-white p-8 rounded-lg shadow-2xl text-center transform transition-all scale-95">
                <h2 id="confirm-title" class="text-2xl font-bold text-gray-800 mb-4">Mostrar Resposta?</h2>
                <p id="confirm-subtitle" class="text-gray-600 mb-6">Isso preencher√° todo o tabuleiro e encerrar√° o jogo
                    atual. Voc√™ tem certeza?</p>
                <div class="flex justify-center gap-4">
                    <button id="confirm-cancel-btn"
                        class="bg-gray-300 text-gray-800 px-6 py-2 rounded-md font-semibold hover:bg-gray-400"
                        data-lang-key="cancel">Cancelar</button>
                    <button id="confirm-show-btn"
                        class="bg-red-600 text-white px-6 py-2 rounded-md font-semibold hover:bg-red-700"
                        data-lang-key="confirm">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // --- IMPORTS ---
        import { SudokuGame } from './js/modules/game-enhanced.js';
        
        // --- M√ìDULO DE TRADU√á√ÉO ---
        const translations = {
            en: {
                mainTitle: "Sudoku Game",
                subtitle: "Challenge your logic and have fun!",
                difficultyLabel: "Difficulty:",
                easy: "Easy",
                medium: "Medium",
                hard: "Hard",
                expert: "Expert",
                insane: "Insane",
                newGame: "New Game",
                reset: "Reset",
                undo: "Undo",
                redo: "Redo",
                clearColors: "Clear Colors",
                settings: "Settings",
                hint: "Hint",
                notes: "Notes",
                notesActive: "Notes Mode",
                showAnswer: "Answer",
                winTitle: "Congratulations!",
                winSubtitle: "You have completed the Sudoku!",
                playAgain: "Play Again",
                confirmTitle: "Show Answer?",
                confirmSubtitle: "This will fill the entire board and end the current game. Are you sure?",
                cancel: "Cancel",
                confirm: "Confirm",
                langToggle: "JP",
                "how-to-play": "How to Play",
                keyboard: "Keyboard",
                "mouse-touch": "Mouse/Touch",
                features: "Features",
                "insert-numbers": "Insert numbers",
                "notes-mode": "Notes mode",
                "toggle-notes": "Toggle notes mode",
                "cycle-colors": "Cycle through colors",
                "apply-color": "Apply selected color",
                undo: "Undo",
                redo: "Redo",
                hint: "Hint",
                delete: "Delete",
                navigate: "Navigate",
                "click-select": "Click to select cell",
                "click-highlight": "Click number to highlight",
                "mobile-panel": "Mobile: Use bottom panel",
                "number-counter": "Number counter (corner)",
                "notes-system": "Notes system",
                "color-system": "Color system",
                "auto-highlight": "Auto highlight"
            },
            pt: {
                mainTitle: "Jogo Sudoku",
                subtitle: "Desafie sua l√≥gica e divirta-se!",
                difficultyLabel: "Dificuldade:",
                easy: "F√°cil",
                medium: "M√©dio",
                hard: "Dif√≠cil",
                expert: "Expert",
                insane: "Insano",
                newGame: "Novo Jogo",
                reset: "Reiniciar",
                undo: "Desfazer",
                redo: "Refazer",
                clearColors: "Limpar Cores",
                settings: "Configura√ß√µes",
                hint: "Dica",
                notes: "Notas",
                notesActive: "Modo Notas",
                showAnswer: "Resposta",
                winTitle: "Parab√©ns!",
                winSubtitle: "Voc√™ completou o Sudoku!",
                playAgain: "Jogar Novamente",
                confirmTitle: "Mostrar Resposta?",
                confirmSubtitle: "Isso preencher√° todo o tabuleiro e encerrar√° o jogo atual. Tem certeza?",
                cancel: "Cancelar",
                confirm: "Confirmar",
                langToggle: "JP",
                "how-to-play": "Como Jogar",
                keyboard: "Teclado",
                "mouse-touch": "Mouse/Touch",
                features: "Recursos",
                "insert-numbers": "Inserir n√∫meros",
                "notes-mode": "Modo notas",
                "toggle-notes": "Alternar modo notas",
                "cycle-colors": "Alternar entre cores",
                "apply-color": "Aplicar cor selecionada",
                undo: "Desfazer",
                redo: "Refazer",
                hint: "Dica",
                delete: "Apagar",
                navigate: "Navegar",
                "click-select": "Clique para selecionar c√©lula",
                "click-highlight": "Clique em n√∫mero para destacar",
                "mobile-panel": "Mobile: Use painel inferior",
                "number-counter": "Contador de n√∫meros (canto)",
                "notes-system": "Sistema de notas",
                "color-system": "Sistema de cores",
                "auto-highlight": "Destaque autom√°tico"
            },
            ja: {
                mainTitle: "Êï∞Áã¨„Ç≤„Éº„É†„ÄÄÔºàÊØç„Å°„ÇÉ„ÇìÁî®Ôºâ",
                subtitle: "Ë´ñÁêÜ„Å´ÊåëÊà¶„Åó„Å¶Ê•Ω„Åó„Çì„Åß„Åè„Å†„Åï„ÅÑÔºÅ",
                difficultyLabel: "Èõ£ÊòìÂ∫¶:",
                easy: "Á∞°Âçò",
                medium: "‰∏≠Á¥ö",
                hard: "Èõ£„Åó„ÅÑ",
                expert: "„Ç®„Ç≠„Çπ„Éë„Éº„Éà",
                insane: "Ë∂ÖÈõ£Èñ¢„ÄÄ„ÄêÁúüÂºìÁî®Ôºâ",
                newGame: "Êñ∞„Åó„ÅÑ„Ç≤„Éº„É†",
                reset: "„É™„Çª„ÉÉ„Éà",
                undo: "ÂÖÉ„Å´Êàª„Åô",
                redo: "„ÇÑ„ÇäÁõ¥„Åô",
                clearColors: "Ëâ≤„Çí„ÇØ„É™„Ç¢",
                settings: "Ë®≠ÂÆö",
                hint: "„Éí„É≥„Éà",
                notes: "„É°„É¢",
                notesActive: "„É°„É¢„É¢„Éº„Éâ",
                showAnswer: "Á≠î„Åà",
                winTitle: "„Åä„ÇÅ„Åß„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ",
                winSubtitle: "Êï∞Áã¨„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åó„ÅüÔºÅ",
                playAgain: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§",
                confirmTitle: "Á≠î„Åà„ÇíË°®Á§∫„Åó„Åæ„Åô„ÅãÔºü",
                confirmSubtitle: "„Åì„Çå„Å´„Çà„Çä„ÄÅ„Åô„Åπ„Å¶„ÅÆ„Éû„Çπ„ÅåÂüã„ÇÅ„Çâ„Çå„ÄÅÁèæÂú®„ÅÆ„Ç≤„Éº„É†„ÅØÁµÇ‰∫Ü„Åó„Åæ„Åô„ÄÇ„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü",
                cancel: "„Ç≠„É£„É≥„Çª„É´",
                confirm: "Á¢∫Ë™ç",
                langToggle: "PT",
                "how-to-play": "ÈÅä„Å≥Êñπ",
                keyboard: "„Ç≠„Éº„Éú„Éº„Éâ",
                "mouse-touch": "„Éû„Ç¶„Çπ/„Çø„ÉÉ„ÉÅ",
                features: "Ê©üËÉΩ",
                "insert-numbers": "Êï∞Â≠ó„ÇíÂÖ•Âäõ",
                "notes-mode": "„É°„É¢„É¢„Éº„Éâ",
                "toggle-notes": "„É°„É¢„É¢„Éº„ÉâÂàáÊõø",
                "cycle-colors": "Ëâ≤„ÇíÂæ™Áí∞",
                "apply-color": "ÈÅ∏Êäû„Åó„ÅüËâ≤„ÇíÈÅ©Áî®",
                undo: "ÂÖÉ„Å´Êàª„Åô",
                redo: "„ÇÑ„ÇäÁõ¥„Åô",
                hint: "„Éí„É≥„Éà",
                delete: "ÂâäÈô§",
                navigate: "„Éä„Éì„Ç≤„Éº„Éà",
                "click-select": "„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Çª„É´„ÇíÈÅ∏Êäû",
                "click-highlight": "Êï∞Â≠ó„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Éè„Ç§„É©„Ç§„Éà",
                "mobile-panel": "„É¢„Éê„Ç§„É´: ‰∏ã„ÅÆ„Éë„Éç„É´„Çí‰ΩøÁî®",
                "number-counter": "Êï∞Â≠ó„Ç´„Ç¶„É≥„Çø„ÉºÔºàËßíÔºâ",
                "notes-system": "„É°„É¢„Ç∑„Çπ„ÉÜ„É†",
                "color-system": "„Ç´„É©„Éº„Ç∑„Çπ„ÉÜ„É†",
                "auto-highlight": "Ëá™Âãï„Éè„Ç§„É©„Ç§„Éà"
            }
        };

        let currentLang = 'ja'; // Japon√™s como padr√£o

        function updateUIText() {
            document.body.className = document.body.className.replace(/lang-\w+/g, '');
            document.body.classList.add(`lang-${currentLang}`);

            const t = translations[currentLang];
            document.getElementById('main-title').textContent = t.mainTitle;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('difficulty-label').textContent = t.difficultyLabel;
            document.querySelector('[data-difficulty="easy"]').textContent = t.easy;
            document.querySelector('[data-difficulty="medium"]').textContent = t.medium;
            document.querySelector('[data-difficulty="hard"]').textContent = t.hard;
            document.querySelector('[data-difficulty="expert"]').textContent = t.expert;
            document.querySelector('[data-difficulty="insane"]').textContent = t.insane;
            document.getElementById('new-game-btn').textContent = t.newGame;
            document.getElementById('reset-btn').textContent = t.reset;
            document.getElementById('undo-btn').textContent = t.undo;
            document.getElementById('redo-btn').textContent = t.redo;
            document.getElementById('clear-colors-btn').textContent = t.clearColors;
            document.getElementById('settings-btn').textContent = t.settings;
            document.getElementById('hint-btn').textContent = t.hint;
            document.getElementById('notes-btn').textContent = t.notes;
            document.getElementById('show-answer-btn').textContent = t.showAnswer;
            document.getElementById('win-title').textContent = t.winTitle;
            document.getElementById('win-subtitle').textContent = t.winSubtitle;
            document.getElementById('modal-new-game-btn').textContent = t.playAgain;
            document.getElementById('confirm-title').textContent = t.confirmTitle;
            document.getElementById('confirm-subtitle').textContent = t.confirmSubtitle;
            document.getElementById('confirm-cancel-btn').textContent = t.cancel;
            document.getElementById('confirm-show-btn').textContent = t.confirm;
            
            // Atualizar elementos com data-translate
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (t[key]) {
                    element.textContent = t[key];
                }
            });
            
            // Atualizar bot√µes de idioma
            updateLanguageButtons();
        }

        function updateLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            langButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === currentLang) {
                    btn.classList.add('active');
                }
            });
        }

        function setLanguage(lang) {
            currentLang = lang;
            updateUIText();
        }

        // O jogo agora usa a classe SudokuGame do m√≥dulo game-enhanced.js
        // que inclui todos os sistemas avan√ßados, incluindo o sistema de cores

        // --- PONTO DE ENTRADA DA APLICA√á√ÉO ---
        document.addEventListener('DOMContentLoaded', () => {
            const game = new SudokuGame('sudoku-canvas');

            // --- Event Listeners dos Controles ---
            document.querySelectorAll('.btn-difficulty').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.btn-difficulty').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    game.difficulty = btn.dataset.difficulty;
                    game.startNewGame();
                });
            });

            document.getElementById('new-game-btn').addEventListener('click', () => game.startNewGame());
            document.getElementById('reset-btn').addEventListener('click', () => game.resetBoard());
            document.getElementById('notes-btn').addEventListener('click', () => {
                if (game.notesSystem) {
                    game.notesSystem.toggleNotesMode();
                }
            });

            document.getElementById('modal-new-game-btn').addEventListener('click', () => {
                document.getElementById('win-modal').classList.add('hidden');
                game.startNewGame();
            });

            document.querySelectorAll('.num-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (game.selected.row !== -1) {
                        const num = parseInt(btn.dataset.num);
                        game.placeNumber(game.selected.row, game.selected.col, num);
                    }
                });
            });

            // L√≥gica do Modal de Confirma√ß√£o
            document.getElementById('show-answer-btn').addEventListener('click', () => game.showConfirmModal());
            document.getElementById('confirm-cancel-btn').addEventListener('click', () => game.hideConfirmModal());
            document.getElementById('confirm-show-btn').addEventListener('click', () => {
                game.showAnswer();
                game.hideConfirmModal();
            });

            // Event listeners para os novos bot√µes
            // Bot√µes undo/redo s√£o gerenciados pelo history-system

            document.getElementById('clear-colors-btn').addEventListener('click', () => {
                if (game.colorSystem) {
                    game.colorSystem.clearAllColors();
                }
            });

            document.getElementById('settings-btn').addEventListener('click', () => {
                alert('Configura√ß√µes em desenvolvimento!');
            });

            // L√≥gica dos Seletores de Idioma
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    setLanguage(btn.dataset.lang);
                    game.updateHintButton();
                    game.updateNotesButton();
                });
            });

            // Inicia a UI com o idioma padr√£o
            updateUIText();
        });

    </script>
</body>

</html>